<!DOCTYPE html>
<html>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <title>1ACMN</title>
    <meta name="Peñalara Software" content="GHC-19">
    <style>
    .container {
        max-width: 900px;
        }
    
    /* Estilos específicos para PDF */
    @media print {
        body {
            margin: 0 !important;
            padding: 0 !important;
        }
        .container {
            margin: 0 !important;
            padding: 0 !important;
            max-width: 100% !important;
        }
        .table {
            font-size: 11px;
            margin: 0;
        }
    }
    
    /* Clase para aplicar cuando se exporta PDF */
    .pdf-export {
        margin: 0 !important;
        padding: 0 !important;
    }
    
    .pdf-export .container {
        margin: 0 !important;
        padding: 5px !important;
        max-width: 100% !important;
        width: 100% !important;
    }
    
    .pdf-export .table {
        font-size: 9px !important; /* Fuente más pequeña */
        margin: 0;
        width: 100% !important;
        table-layout: fixed !important; /* Fuerza que las columnas se ajusten */
    }
    
    .pdf-export .table th,
    .pdf-export .table td {
        padding: 2px !important; /* Menos padding */
        line-height: 1.1 !important;
        word-wrap: break-word !important;
    }
</style>
</head>
<body>
    <div id="navbar-container"></div>
    <script>
        fetch('../navbar.html')
        .then(response => response.text())
        .then(html => {
            document.getElementById('navbar-container').innerHTML = html;
        });
    </script>
    <div class="container">
        <table class="table table-bordered">
            <tr>
                <th class="text-center" colspan="6"><i>1ACMN</i></th>
            </tr>
            <tr>
                <th class="text-center"><a href="https://www.penalara.com" target="_blank" rel="noopener noreferrer">/~\</a></th>
                <td class="text-center">Lunes</td>
                <td class="text-center">Martes</td>
                <td class="text-center">Miércoles</td>
                <td class="text-center">Jueves</td>
                <td class="text-center">Viernes</td>
            </tr>
            <tr>
                <th class="text-center">8:30<br>9:30</th>
                <td class="text-center">Principios de sanidad vegetal<br>JLM</td>
                <td class="text-center">Repoblaciones forestales y tratamientos selvícolas<br>AGL</td>
                <td class="text-center">Itinerario Personal Empleabilidad I<br>JAJ</td>
                <td class="text-center">Principios de sanidad vegetal<br>JLM</td>
                <td class="text-center">Repoblaciones forestales y tratamientos selvícolas<br>AGL</td>
            </tr>
            <tr>
                <th class="text-center">9:30<br>10:30</th>
                <td class="text-center">Fundamentos Agronómicos<br>AGL</td>
                <td class="text-center">Fundamentos Agronómicos<br>AGL</td>
                <td class="text-center">Tutoría<br>JLM</td>
                <td class="text-center">Fundamentos Agronómicos<br>AGL</td>
                <td class="text-center">Principios de sanidad vegetal<br>JLM</td>
            </tr>
            <tr>
                <th class="text-center">&nbsp;</th>
                <td class="text-center" colspan="5"><b>recreo</b></td>
            </tr>
            <tr>
                <th class="text-center">11:00<br>12:00</th>
                <td class="text-center" rowspan="3">Maquinaria e instalaciones<br>PCW</td>
                <td class="text-center">Maquinaria e instalaciones<br>PCW</td>
                <td class="text-center">Producción de plantas<br>JLM</td>
                <td class="text-center" rowspan="2">Repoblaciones forestales y tratamientos selvícolas<br>PCW</td>
                <td class="text-center">Maquinaria e instalaciones<br>PCW</td>
            </tr>
            <tr>
                <th class="text-center">12:00<br>13:00</th>
                <td class="text-center" rowspan="2">Producción de plantas<br>JLM</td>
                <td class="text-center">Maquinaria e instalaciones<br>PCW</td>
                <td class="text-center">Sostenibilidad Aplicada al Sistema Productivo<br>RF</td>
            </tr>
            <tr>
                <th class="text-center">13:00<br>14:00</th>
                <td class="text-center" rowspan="2">Repoblaciones forestales y tratamientos selvícolas<br>AGL</td>
                <td class="text-center">Repoblaciones forestales y tratamientos selvícolas<br>AGL</td>
                <td class="text-center">Fundamentos Agronómicos<br>AGL</td>
            </tr>
            <tr>
                <th class="text-center">14:00<br>15:00</th>
                <td class="text-center">Digitalización Aplicada al Sistema Productivo<br>RF</td>
                <td class="text-center">Itinerario Personal Empleabilidad I<br>JAJ</td>
                <td class="text-center">Itinerario Personal Empleabilidad I<br>JAJ</td>
                <td class="text-center">Producción de plantas<br>JLM</td>
            </tr>
            <tr>
                <th class="text-center" colspan="6">Lectivas: 30</th>
            </tr>
            <tr>
                <th class="text-center">&nbsp;30</th>
                <td class="text-center" colspan="3">Profesores</td>
                <td class="text-center" colspan="2">Materias</td>
            </tr>
            <tr>
                <th class="text-center">6</th>
                <td class="text-center" colspan="3">Carmona, Pedro (PCW)</td>
                <td class="text-center" colspan="2">Maquinaria e instalaciones</td>
            </tr>
            <tr>
                <th class="text-center">2</th>
                <td class="text-center" colspan="3">''</td>
                <td class="text-center" colspan="2">Repoblaciones (Repoblaciones forestales y tra)</td>
            </tr>
            <tr>
                <th class="text-center">1</th>
                <td class="text-center" colspan="3">Fresno, Rafael (RF)</td>
                <td class="text-center" colspan="2">Digitalización (Digitalización Aplicada al Sis)</td>
            </tr>
            <tr>
                <th class="text-center">1</th>
                <td class="text-center" colspan="3">''</td>
                <td class="text-center" colspan="2">Sostenibilidad (Sostenibilidad Aplicada al Sis)</td>
            </tr>
            <tr>
                <th class="text-center">4</th>
                <td class="text-center" colspan="3">Gómez-Lama, Álvaro (AGL)</td>
                <td class="text-center" colspan="2">Fundamentos Agronómicos</td>
            </tr>
            <tr>
                <th class="text-center">5</th>
                <td class="text-center" colspan="3">''</td>
                <td class="text-center" colspan="2">Repoblaciones (Repoblaciones forestales y tra)</td>
            </tr>
            <tr>
                <th class="text-center">3</th>
                <td class="text-center" colspan="3">Jiménez, Juan Antonio (JAJ)</td>
                <td class="text-center" colspan="2">IPE I (Itinerario Personal Empleabili)</td>
            </tr>
            <tr>
                <th class="text-center">3</th>
                <td class="text-center" colspan="3">Mudarra, José Luis (JLM)</td>
                <td class="text-center" colspan="2">Principios de sanidad vegetal</td>
            </tr>
            <tr>
                <th class="text-center">4</th>
                <td class="text-center" colspan="3">''</td>
                <td class="text-center" colspan="2">Producción de plantas</td>
            </tr>
            <tr>
                <th class="text-center">1</th>
                <td class="text-center" colspan="3">''</td>
                <td class="text-center" colspan="2">Tutoría</td>
            </tr>
        </table>
    </div>

<button onclick="exportarPDF()" class="btn btn-primary m-3">Exportar a PDF</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
    function exportarPDF() {
        // Aplicar clase especial para PDF
        document.body.classList.add('pdf-export');
        
        var element = document.querySelector('.container');
        var opt = {
            margin:       [0.2, 0.2, 0.2, 0.2], // [top, left, bottom, right] en pulgadas
            filename:     'horario-1ACMN.pdf',
            image:        { type: 'jpeg', quality: 0.95 },
            html2canvas:  { 
                scale: 4,
                useCORS: true,
                letterRendering: true,
                allowTaint: true,
                height: element.scrollHeight + 50,
                width: element.scrollWidth + 50
            },
            jsPDF:        { 
                unit: 'in', 
                format: 'a4', 
                orientation: 'landscape', // Cambio a horizontal
                compress: true
            },
            pagebreak: { mode: 'avoid-all' }
        };
        
        html2pdf().set(opt).from(element).save().then(function() {
            // Quitar clase especial después de exportar
            document.body.classList.remove('pdf-export');
        });
    }
</script>
</body>
</html>